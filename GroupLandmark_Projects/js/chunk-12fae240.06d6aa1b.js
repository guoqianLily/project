(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12fae240"],{"687c":function(e,t,r){var n=r("abd8");t=n(!1),t.push([e.i,".posennolExpire header{width:100%;padding:10px 0;line-height:30px;border-bottom:1px solid #ebeef5}.posennolExpire header .el-row{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;margin-bottom:14px}.posennolExpire header .title{width:80px;text-align:right}.posennolExpire header .el-col-1,.posennolExpire header .el-col-4,.posennolExpire header .el-col-5,.posennolExpire header .el-col-6{display:-webkit-box;display:-ms-flexbox;display:flex}.posennolExpire header .selectbox{width:70%;float:right;height:100%;line-height:30px;text-align:right;padding-right:10px;-webkit-box-sizing:border-box;box-sizing:border-box}.posennolExpire header .selectbox li{font-size:14px;color:#333;font-weight:600;display:inline-block}.posennolExpire header .selectbox li .el-input__inner{height:30px;line-height:30px}.posennolExpire header .selectbox li .el-select{width:150px}.posennolExpire header .selectbox li .el-input__icon{line-height:30px}.posennolExpire header .selectbox li label{margin:0 8px}.posennolExpire .el-button--mini,.posennolExpire .el-button--mini.is-round,.posennolExpire .el-button--small,.posennolExpire .el-button--small.is-round{padding:6px}.posennolExpire .el-input--suffix .el-input__inner{padding-right:15px}.posennolExpire .el-table th.gutter{display:table-cell!important}.posennolExpire .el-input{width:auto!important}",""]),e.exports=t},afcc:function(e,t,r){"use strict";var n=r("c868"),o=r.n(n);o.a},c868:function(e,t,r){var n=r("687c");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=r("85cb").default;o("01c636b8",n,!0,{sourceMap:!1,shadowMode:!1})},d7a07:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"posennolExpire",staticStyle:{width:"100%",height:"100%"},attrs:{"element-loading-text":"拼命加载中","element-loading-background":"rgba(255, 255, 255, 1)"}},[r("header",[r("el-row",{staticClass:"header"},[r("el-col",{attrs:{span:1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.seachAllData}},[e._v("查询")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-printer",size:"small"},on:{click:e.export2Excel}},[e._v("导出")])],1)],1)],1),r("section",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,height:e.heightItem,"max-height":e.heightItem,border:"",id:"personnelBaseInfoTable","header-cell-style":{padding:"8px 0"},"cell-style":{padding:"5px 0"}}},[r("el-table-column",{attrs:{align:"center",type:"index",label:"序号"}}),r("el-table-column",{attrs:{prop:"userName",label:"姓名"}}),r("el-table-column",{attrs:{prop:"detpName",label:"部门"}}),r("el-table-column",{attrs:{prop:"titleName",label:"岗位"}}),r("el-table-column",{attrs:{label:"合同期限",align:"center"}},[r("el-table-column",{attrs:{prop:"contractBeginTime",label:"开始时间",align:"center"}}),r("el-table-column",{attrs:{prop:"contractEndTime",label:"结束时间",align:"center"}})],1)],1)],1)])])},o=[],i=(r("5ab2"),r("47e7"),r("e10e"),r("6d57"),r("ac9f")),l=r("365c"),a=r("751a"),s=r("8876");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(i["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={data:function(){return{loading:!0,formLabelWidth:"130px",conversionDate:[],labelPosition:"right",tableData:[],heightItem:window.innerHeight-160,LIST:[],wopts:{bookType:"xlsx",bookSST:!0,type:"binary",cellStyles:!0}}},watch:{heightItem:function(e){if(!this.timer){this.heightItem=e,this.timer=!0;var t=this;setTimeout((function(){t.timer=!1}),400)}}},computed:p({},Object(s["b"])({userId:function(e){return e.user.userId}})),methods:{seachAllData:function(){var e=this;Object(a["a"])({url:l["a"].personExpirationOfContract,method:"POST",data:{userId:this.$store.state.user.userId}}).then((function(t){var r=t.data,n=t.status;if(200==n){var o=r.result;e.tableData=o,e.loading=!1}else e.loading=!1})).catch((function(t){e.loading=!1,console.log(t)}))},getStyle:function(e){var t=null;return t=window.getComputedStyle?window.getComputedStyle(e,null):e.currentStyle,t},export2Excel:function(){var e=this;Object(a["a"])({url:l["a"].personExpirationOfContract,method:"POST",data:{userId:this.$store.state.user.userId}}).then((function(t){var r=t.data,n=t.status;if(200==n){var o=r.result;e.LIST=r.result;for(var i={"员工合同到期清单":"员工合同到期清单",userName:"姓名",detpName:"部门",titleName:"岗位",contractBeginTime:"合同开始时间",contractEndTime:"合同结束时间"},l=[{"员工合同到期清单":"","姓名":"","部门":"","岗位":"","合同开始时间":"","合同结束时间":""},{"员工合同到期清单":"序号","姓名":"姓名","部门":"部门","岗位":"岗位","合同开始时间":"合同期限","合同结束时间":""},{"员工合同到期清单":"","姓名":"","部门":"","岗位":"","合同开始时间":"开始时间","合同结束时间":"结束时间"}],a=0;a<o.length;a++){var s=new Object;for(var c in i){var p=i[c];s[p]="员工合同到期清单"==p?a+1+"":o[a][c]?o[a][c]:""}l[a+3]=s}e.downloadExl2(l,"xlsx")}})).catch((function(e){console.log(e)}))},saveAs2:function(e,t){var r=document.createElement("a");r.download=t||"未命名","msSaveOrOpenBlob"in navigator?window.navigator.msSaveOrOpenBlob(e,"员工合同到期清单.xlsx"):r.href=URL.createObjectURL(e),r.click(),setTimeout((function(){URL.revokeObjectURL(e)}),100)},downloadExl2:function(e,t){var r=this,n=e[0];e.unshift({});var o=[];for(var i in n)o.push(i),e[0][i]=i;n=[];e.map((function(e,t){return o.map((function(n,o){return Object.assign({},{v:e[n],position:(o>25?r.getCharCol(o):String.fromCharCode(65+o))+(t+1)})}))})).reduce((function(e,t){return e.concat(t)})).forEach((function(e,t){return n[e.position]={v:e.v}}));var l=Object.keys(n);n["!merges"]=[{s:{c:0,r:0},e:{c:5,r:1}},{s:{c:0,r:2},e:{c:0,r:3}},{s:{c:1,r:2},e:{c:1,r:3}},{s:{c:2,r:2},e:{c:2,r:3}},{s:{c:3,r:2},e:{c:3,r:3}},{s:{c:4,r:2},e:{c:5,r:2}}];var a={bottom:{style:"thin",color:{rgb:"000000"}},top:{style:"thin",color:{rgb:"000000"}},left:{style:"thin",color:{rgb:"000000"}},right:{style:"thin",color:{rgb:"000000"}}},s={border:a,alignment:{horizontal:"center",wrapText:!0,vertical:"center"},font:{name:"宋体",sz:24,bold:!0,color:{rgb:"000000"},outline:!0},fill:{fgColor:{rgb:"FFFFFF"},bgColor:{indexed:64}}},c={border:a,alignment:{horizontal:"center",wrapText:!0,vertical:"center"},font:{name:"宋体",sz:12,color:{rgb:"000000"},outline:!0}},p={border:a,alignment:{horizontal:"center",wrapText:!0,vertical:"center"},font:{name:"宋体",sz:12,bold:!1,color:{rgb:"000000"},outline:!0},fill:{fgColor:{rgb:"B8CCE4"},bgColor:{rgb:"red"}}};n["A1"].s=s,n["A3"].s=p,n["B3"].s=p,n["C3"].s=p,n["D3"].s=p,n["E3"].s=p,n["F3"].s=p,n["A4"].s=p,n["B4"].s=p,n["C4"].s=p,n["D4"].s=p,n["E4"].s=p,n["F4"].s=p;for(var d=5;d<this.tableData.length+5;d++)n["A"+d].s=c,n["B"+d].s=c,n["C"+d].s=c,n["D"+d].s=c,n["E"+d].s=c,n["F"+d].s=c;n["!cols"]=[{wpx:50},{wpx:100},{wpx:130},{wpx:130},{wpx:120},{wpx:120}],n["!rows"]=[{hpt:100}];var h={SheetNames:["员工合同到期清单"],Sheets:{"员工合同到期清单":Object.assign({},n,{"!ref":l[0]+":"+l[l.length-1]})}},b=new Blob([this.s2ab(XLSX.write(h,{bookType:void 0==t?"xlsx":t,bookSST:!1,type:"binary"}))],{type:""});this.saveAs2(b,"员工合同到期清单."+("biff2"==this.wopts.bookType?"xlsx":this.wopts.bookType))},getCharCol:function(e){var t="",r=0;while(e>0)r=e%26+1,t=String.fromCharCode(r+64)+t,e=(e-r)/26;return t},s2ab:function(e){if("undefined"!==typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}for(t=new Array(e.length),n=0;n!=e.length;++n)t[n]=255&e.charCodeAt(n);return t}},created:function(){this.seachAllData()},mounted:function(){var e=this;window.onresize=function(){return function(){e.heightItem=window.innerHeight-160}()}}},h=d,b=(r("afcc"),r("623f")),u=Object(b["a"])(h,n,o,!1,null,null,null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-12fae240.06d6aa1b.js.map